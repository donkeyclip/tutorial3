/*
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */

import helper, { validateGoogleFontUrl } from '../../../../_coreUtils/helper';

function loadGoogleFont(doc, theFont) {
  const fontTag = doc.createElement('link');
  fontTag.setAttribute('rel', 'stylesheet');
  if (!validateGoogleFontUrl(theFont.src)) {
    helper.error(
      `Only valid google font url are accepted on src of a google-font. ${theFont.src} provided. No font will loaded`,
    );
    return fontTag;
  }
  fontTag.setAttribute('href', theFont.src);
  return fontTag;
}

export default function createFontTag(doc, theFont) {
  if (theFont.type === 'google-font') {
    return loadGoogleFont(doc, theFont);
  }
  // return a generic font tag
  helper.error(
    `The provided font type is not one of the supported. ${theFont.type} provided. Aborting loading font.`,
  );
  const fontTag = doc.createElement('link');
  fontTag.setAttribute('rel', 'stylesheet');
  return fontTag;
}
